# Работа с Дзен Мани через Google Таблицы
Экспорт и импорт транзакций, счетов и категорий.

Данная серия скриптов предназначена для интеграции данных приложения Дзен Мани с Google Таблицами.

Дзен Мани хранит данные в формате JSON, в виде нескольких словарей ('accounts', 'tags', 'merchants', 'transactions' для аккаунтов, категорий, мест и транзакций) с полями, описывающими объект. Все объекты используют UUID в качестве идентификатора. UUID уникальны, и не принимаются к повторному использованию. Это значит, что при удалении категории или счёта, состояние "как было" вернуть уже невозможно, а можно только завести новые объекты с теми же свойствами. Таким образом, даже если вы сохраните полный слепок данных на определённую дату, бэкап сопряжён с определёнными сложностями, если вы меняли и, в особенности, удаляли счета и категории. Самый простой способ восстановления - сбросить аккаунт до чистого состояния, и импортировать все объекты с чистого листа.

Для работы используются
Скрипт Settings с настройками остальных скриптов - обязателен для всех
Скрипт Main с описанием основных функций по синхронизации данных - обязателен для всех
Скрипт Logs для логгирования - обязателен для всех
Скрипт Dictionaries - для операций со словарями. Необходим для экспорта, импорта, и работы со счетами.
Скрипт Export - для экспорта транзакций с сервера в Google Таблицы
Скрипт Import - для импорта транзакций на сервер из Google Таблиц
Скрипт Changes - для автоматического отслеживания измененных транзакций на листе
Скрипт Categories - для импорта и экспорта данных по категориям
Скрипт Accounts - для импорта и экспорта данных по счетам
Скрипт Merchants - для импорта и экспорта данных по местам

Экспорт данных в Google Таблицы относительно безопасен, скрипт просто забирает их с сервера. Любые запросы на изменение данных выполняются на ваш страх и риск. Защита от дурака предусмотрена, но я не стал покрывать все случаи.

Скрипты добавляют следующие кнопки:

Меню Zenmoney (создатся через скрипт Main):
 * кнопка FullSync (скрипт Main): последовательно вызывает скрипты синхронизации и экспорта транзакций, словарей, категорий, счетов и мест.
 * подменю Export (скрипт Export):
  ** Full Export: полный экспорт скачивает все доступные на сервере транзакции и записывает их на лист экспорта.
  ** Incr Export: инкрементальный экспорт скачивает изменения на сервере с последней синхронизации и применяет их к листу экспорта.
  ** Prepare Changes Sheet: подготовка изменений скачивает изменения на сервере и записывает их в отдельный лист изменений
  ** Apply Changes to Data Sheet: применяет изменения с отдельного листа к листу экспорта
  ** Update Dictionaries: обновляет данные на листе словарей
 * подменю Import (скрипт Import):
  ** Full Import: полный импорт передает на сервер все операции с листа импорта, как новые
  ** Incr Import: иинкрементальный импорт передает на сервер только новые операции, а также операции, отмеченные соответствующим чекбоксом
  ** Set Triggers (скрипт Changes): включает триггеры отслеживания изменений на листе импорта, выставляющие чекбокс при изменении существенных данных транзакции
  ** Delete Triggers (скрипт Changes): выключает триггеры отслеживания изменений на листе импорта
 * подменю Categories (скрипт Categories):
  ** Load: экспорт категорий с сервера на отдельный лист
  ** Save: импорт категорий с отдельного листа на сервер
 * подменю Accounts (скрипт Accounts):
  ** Load: экспорт счетов с сервера на отдельный лист
  ** Save: импорт счетов с отдельного листа на сервер
 * подменю Merchants (скрипт Merchants):
  ** Load: экспорт мест с сервера на отдельный лист
  ** Save: импорт мест с отдельного листа на сервер








